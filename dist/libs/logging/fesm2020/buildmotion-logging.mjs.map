{"version":3,"file":"buildmotion-logging.mjs","sources":["../../../../libs/logging/src/lib/log-writers/log-writer.ts","../../../../libs/logging/src/lib/log-entry.ts","../../../../libs/logging/src/lib/severity.enum.ts","../../../../libs/logging/src/lib/logging.service.ts","../../../../libs/logging/src/lib/log-writers/console-writer.ts","../../../../libs/logging/src/lib/log-writers/data-dog-writer.service.ts","../../../../libs/logging/src/lib/logging.module.ts","../../../../libs/logging/src/lib/logging.service.config.ts","../../../../libs/logging/src/lib/logging.service.mock.ts","../../../../libs/logging/src/buildmotion-logging.ts"],"sourcesContent":["import { IsNotNullOrUndefined, IsTrue, StringIsNotNullEmptyRange, ValidationContext } from '@buildmotion/rules-engine';\nimport { noop } from 'rxjs';\nimport { ILogEntry } from '../i-log-entry';\nimport { ILogWriter } from './i-log-writer';\n\nexport abstract class LogWriter implements ILogWriter {\n  hasWriter!: boolean;\n  targetEntry!: ILogEntry;\n\n  /**\n   * Use this method to execute the write process for the\n   * specified [Log Entry] item.\n   *\n   * Using the [template method] design pattern.\n   */\n  execute(): void {\n    this.setup();\n    if (this.validateEntry()) {\n      this.write();\n    }\n    this.finish();\n  }\n\n  /**\n   * Use to perform an setup or configuration of the [writer].\n   * The [setup] method runs on all executions of the writer - and\n   * is called before the [write] method.\n   */\n  public abstract setup(): void;\n\n  /**\n   * Use to validate the [log entry] before attempting to write\n   * using the specified [log writer].\n   *\n   * Returns a [false] boolean to indicate the item is not valid.\n   */\n  public validateEntry(): boolean {\n    const validationContext = new ValidationContext();\n    validationContext.addRule(new IsTrue('LogWriterExists', 'The log writer is not configured.', this.hasWriter));\n    validationContext.addRule(new IsNotNullOrUndefined('EntryIsNotNull', 'The entry cannot be null.', this.targetEntry));\n    validationContext.addRule(new StringIsNotNullEmptyRange('SourceIsRequired', 'The entry source is not valid.', this.targetEntry.source, 1, 100));\n    validationContext.addRule(new StringIsNotNullEmptyRange('MessageIsValid', 'The message is required for the [Log Entry].', this.targetEntry.message, 1, 2000));\n    validationContext.addRule(new IsNotNullOrUndefined('TimestampIsRequired', 'The timestamp must be a valid DateTime value.', this.targetEntry.timestamp));\n\n    return validationContext.renderRules().isValid;\n  }\n\n  /**\n   * Use to implement the actual write of the [Log Entry].\n   */\n  public abstract write(): void;\n\n  /**\n   * Use to finish the process or clean-up any resources.\n   */\n  public finish(): void {\n    noop();\n  }\n}\n","import { ILogEntry } from './i-log-entry';\nimport { Severity } from './severity.enum';\n\nexport class LogEntry implements ILogEntry {\n  application: string;\n  source: string;\n  severity: Severity;\n  message: string;\n  timestamp: Date;\n  tags?: string[];\n\n  constructor(application: string, source: string, severity: Severity, message: string, tags?: string[] | undefined) {\n    this.application = application;\n    this.source = source;\n    this.severity = severity;\n    this.message = message;\n    this.timestamp = new Date(Date.now());\n    this.tags = tags;\n  }\n}\n","export enum Severity {\n  Information = 'Information',\n  Warning = 'Warning',\n  Error = 'Error',\n  Critical = 'Critical',\n  Debug = 'Debug',\n}\n","import { Injectable, Optional } from '@angular/core';\nimport { ConfigurationService, IConfiguration, LoggingConfig } from '@buildmotion/configuration';\nimport { Guid } from 'guid-typescript';\nimport { Observable, ReplaySubject } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { ILogEntry } from './i-log-entry';\nimport { LogEntry } from './log-entry';\nimport { Severity } from './severity.enum';\n\nexport interface ILoggingService {\n  serviceName: string;\n  source: string;\n  severity: Severity;\n  message: string;\n  timestamp: Date;\n  applicationName: string;\n  version: string;\n  isProduction: boolean;\n  config: LoggingConfig;\n  id: Guid;\n  logEntries$: Observable<ILogEntry>;\n  // configService: ConfigurationService;\n  handleSettings(settings: IConfiguration): void;\n  log(source: string, severity: Severity, message: string, tags?: string[]): void;\n}\n@Injectable()\nexport class LoggingService implements ILoggingService {\n  serviceName = 'LoggingService';\n  source!: string;\n  severity!: Severity;\n  message!: string;\n  timestamp: Date = new Date();\n  applicationName!: string;\n  version!: string;\n  isProduction!: boolean;\n  config!: LoggingConfig;\n  id: Guid = Guid.create();\n\n  private logEntriesSubject: ReplaySubject<ILogEntry> = new ReplaySubject<ILogEntry>(1);\n  public readonly logEntries$: Observable<ILogEntry> = this.logEntriesSubject.asObservable();\n\n  /**\n   * The [LoggingService] constructor.\n   */\n  constructor(@Optional() public configService: ConfigurationService) {\n    this.log(this.serviceName, Severity.Information, `Starting logging service [${this.id.toString()}] at: ${this.timestamp}`);\n    this.initializeService(configService);\n  }\n\n  /**\n   * Use to initialize the logging service. Retrieves\n   * application configuration settings.\n   *\n   * @param configService contains the configuration settings for the application\n   */\n  private initializeService(configService: ConfigurationService) {\n    if (configService) {\n      this.configService.settings$.pipe(take(1)).subscribe((settings) => this.handleSettings(settings));\n    }\n  }\n\n  /**\n   * Use to handle settings from the configuration service.\n   * @param settings\n   */\n  handleSettings(settings: IConfiguration) {\n    if (settings) {\n      this.config = settings.loggingConfig;\n\n      this.applicationName = this.config && this.config.applicationName ? this.config.applicationName : 'Angular';\n      this.isProduction = this.config && this.config.isProduction ? this.config.isProduction : false;\n    }\n  }\n\n  /**\n   * Use this method to send a log message with severity and source information\n   * to the application's logger.\n   *\n   * If the application environment mode is [Production], the information will\n   * be sent to a centralized repository.\n   *\n   * @param source\n   * @param severity\n   * @param message\n   */\n  log(source: string, severity: Severity, message: string, tags?: string[]) {\n    this.source = this.applicationName !== source ? `${this.applicationName}.${source}` : this.applicationName;\n    this.severity = severity;\n    this.message = message;\n    this.timestamp = new Date();\n\n    if (tags) {\n      tags.push(`LoggerId:${this.id.toString()}`);\n    } else {\n      tags = [`LoggerId:${this.id.toString()}`];\n    }\n\n    const logEntry = new LogEntry(this.applicationName, this.source, this.severity, this.message, tags);\n    this.logEntriesSubject.next(logEntry);\n  }\n}\n","import { ILogEntry } from '../i-log-entry';\nimport { Injectable } from '@angular/core';\nimport { LogWriter } from './log-writer';\nimport { LoggingService } from '../logging.service';\nimport { Severity } from '../severity.enum';\nimport { noop } from 'rxjs';\n\n/**\n * Use this writer to log information to the browser console.\n */\n@Injectable()\nexport class ConsoleWriter extends LogWriter {\n  constructor(private loggingService: LoggingService) {\n    super();\n    if (loggingService.config.isProduction === false) {\n      this.loggingService.logEntries$.subscribe((logEntry) => this.handleLogEntry(logEntry));\n    }\n  }\n\n  handleLogEntry(logEntry: ILogEntry) {\n    this.targetEntry = logEntry;\n    this.execute();\n  }\n\n  /**\n   * No setup required for the console writer.\n   */\n  public setup(): void {\n    noop();\n  }\n\n  /**\n   * Implementation of the abstract method. This will perform the\n   * actual `write` action for the specified writer.\n   */\n  public write(): void {\n    switch (this.targetEntry.severity) {\n      /* eslint-disable no-restricted-syntax */\n      /* eslint-disable no-console */\n      case Severity.Debug:\n        console.debug(this.targetEntry);\n        break;\n      case Severity.Information:\n        console.info(this.targetEntry);\n        break;\n      case Severity.Warning:\n        console.warn(this.targetEntry);\n        break;\n      case Severity.Error:\n        console.error(this.targetEntry);\n        break;\n      case Severity.Critical:\n        console.error(this.targetEntry);\n        break;\n      default:\n        break;\n      /* eslint-enable no-restricted-syntax */\n      /* eslint-enable no-console */\n    }\n  }\n}\n","import { Injectable, Optional } from '@angular/core';\nimport { ConfigurationService, IConfiguration, IDataDogConfig } from '@buildmotion/configuration';\nimport { ILogEntry } from '../i-log-entry';\nimport { LoggingService } from '../logging.service';\nimport { LogWriter } from './log-writer';\nimport { datadogLogs } from '@datadog/browser-logs';\nimport { Severity } from '../severity.enum';\nimport { datadogRum } from '@datadog/browser-rum';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DataDogWriterService extends LogWriter {\n  config: IDataDogConfig | undefined;\n\n  constructor(\n    @Optional() private configService: ConfigurationService,\n    private loggingService: LoggingService,\n  ) {\n    super();\n    if (this.configService && this.loggingService) {\n      this.configService.settings$.subscribe((settings) =>\n        this.handleSettings(settings)\n      );\n      this.loggingService.logEntries$.subscribe((entry) =>\n        this.handleLogEntry(entry)\n      );\n    }\n  }\n\n  handleLogEntry(entry: ILogEntry) {\n    if (this.hasWriter) {\n      this.targetEntry = entry;\n      this.execute();\n    }\n  }\n\n  handleSettings(settings: IConfiguration) {\n    if (settings) {\n      this.config = settings.dataDogConfig;\n      this.hasWriter = true;\n      console.log(`Initializing [DataDog] writer for logging.`);\n\n      /**\n       * Use to initialize client-browser log transfer to DataDog;\n       */\n      datadogLogs.init({\n        clientToken: this.config.logs.clientToken,\n        site: this.config.logs.site,\n        forwardErrorsToLogs: this.config.logs.forwardErrorsToLogs,\n        sampleRate: this.config.logs.sampleRate\n      });\n\n      /**\n       * Note: The trackInteractions initialization parameter enables the automatic collection of user\n       * clicks in your application.Sensitive and private data contained on your pages may be included to\n       * identify the elements interacted with.\n       *\n       * version: Specify a version number to identify the deployed version of your application in Datadog\n       */\n      datadogRum.init({\n        applicationId: this.config.realUserMonitoring.applicationId,\n        clientToken: this.config.realUserMonitoring.clientToken,\n        site: this.config.realUserMonitoring.site,\n        service: this.config.realUserMonitoring.service,\n        env: this.config.realUserMonitoring.env,\n        // Specify a version number to identify the deployed version of your application in Datadog\n        version: this.config.realUserMonitoring.version,\n        sampleRate: this.config.realUserMonitoring.sampleRate,\n        trackInteractions: this.config.realUserMonitoring.trackInteractions\n      });\n    }\n  }\n\n  /**\n   * Use to perform an setup or configuration of the [writer].\n   * The [setup] method runs on all executions of the writer - and\n   * is called before the [write] method.\n   */\n  public setup(): void {\n    if (this.hasWriter && this.config && this.targetEntry) {\n      try {\n        // FIXME: DO WE NEED TO SOMETHING HERE? Nope.\n      } catch (error) {\n        if (error && error instanceof Error) {\n          const message = `${this.targetEntry.application}.DataDogWriter: ${error?.message ?? ''}, ${error?.stack ?? error.stack}`;\n          console.error(message);\n        }\n      }\n    }\n  }\n\n  /**\n   * Use to implement the actual write of the [Log Entry].\n   */\n  public write(): void {\n    if (this.targetEntry) {\n      switch (this.targetEntry.severity) {\n        case Severity.Information:\n          datadogLogs.logger.info(this.targetEntry.application, { ...this.targetEntry });\n          break;\n        case Severity.Warning:\n          datadogLogs.logger.warn(this.targetEntry.application, { ...this.targetEntry });\n          break;\n        case Severity.Error:\n          datadogLogs.logger.error(this.targetEntry.application, { ...this.targetEntry });\n          break;\n        case Severity.Critical:\n          datadogLogs.logger.error(this.targetEntry.application, { ...this.targetEntry });\n          break;\n        case Severity.Debug:\n          datadogLogs.logger.info(this.targetEntry.application, { ...this.targetEntry });\n          break;\n        default:\n          datadogLogs.logger.info(this.targetEntry.application, { ...this.targetEntry });\n      }\n    }\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  imports: [CommonModule],\n})\nexport class LoggingModule {}\n","export class LoggingServiceConfig {\n  public applicationName = 'APP_NAME_NOT_PROVIDED';\n  public version!: string;\n}\n","import { Injectable } from '@angular/core';\nimport { IConfiguration, ILoggingConfig, LoggingConfig } from '@buildmotion/configuration';\nimport { Guid } from 'guid-typescript';\nimport { Subject } from 'rxjs';\nimport { ILogEntry } from './i-log-entry';\nimport { ILoggingService } from './logging.service';\nimport { Severity } from './severity.enum';\n\n\n@Injectable()\nexport class LoggingServiceMock implements ILoggingService {\n  applicationName = 'application';\n  config!: LoggingConfig;\n  configService!: undefined;\n  handleSettings!: () => { unknown: any };\n  id: Guid = Guid.create();\n  isProduction!: boolean;\n  logEntries$: Subject<ILogEntry> = new Subject<ILogEntry>();\n  loggingConfig!: ILoggingConfig;\n  message!: string;\n  serviceName = 'LoggingServiceMock';\n  severity!: Severity;\n  source!: string;\n  stack!: string;\n  timestamp!: Date;\n  version = '0.0.0';\n\n  setupConfiguration(settings: IConfiguration) {\n    if (settings) {\n      this.log(this.serviceName, Severity.Information, `Logging for [${settings.loggingConfig.applicationName}].`);\n    }\n    this.isProduction = false;\n  }\n\n  log(source: string, severity: Severity, message: string) {\n    this.source = source;\n    this.severity = severity;\n    this.message = message;\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["i1.LoggingService","i2.LoggingService"],"mappings":"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"}